<!DOCTYPE html>
<html>

<head>
    <meta name="author" content="">
    <title>Inventory HUD</title>
    <link rel="stylesheet" id="themonic-fonts-css" href="css/contextMenu.min.css" type="text/css" media="all" />
    <link rel="stylesheet" id="themonic-fonts-css" href="css/jquery.dialog.min.css" type="text/css" media="all" />
    <link rel="stylesheet" id="themonic-fonts-css" href="css/ui.min.css" type="text/css" media="all" />
</head>

<body>


    <div id="inventoryHud">
        <div id="title">Satchel</div>

        <div id="inventoryElement">
        </div>
        <p id="information"></p>
        <p id="description"></p>

        <div id="cash">
            <a id="money-value"></a>
        </div>

        <div id="gold">
            <a id="gold-value"></a>
        </div>

        <div id="id">
            <a id="id-value"></a>
        </div>


        <div id="transaction-loader">
            <div class="wrap-model">
                <div class="revolver">
                    <section class="revolver-part"></section>
                    <section class="revolver-part"></section>
                    <section class="revolver-part"></section>
                    <section class="revolver-part"></section>
                    <section class="revolver-part"></section>
                    <section class="revolver-part"></section>
                </div>
                <div id="loading-text"></div>
            </div>
        </div>
    </div>
    <div id="secondInventoryHud">
        <div id="titleHorse"></div>
        <div id="secondInventoryElement">
        </div>
        <p id="information2"></p>
        <div class="capacity">
            <a id="current-cap-value"></a>/<a id="capacity-value"></a>
        </div>
    </div>

    <script type="text/javascript" src="js/vendor/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="js/vendor/jquery-ui.js"></script>
    <script type="text/javascript" src="js/config.js"></script>
    <script type="text/javascript" src="js/contextMenu.min.js"></script>
    <script type="text/javascript" src="js/jquery.dialog.min.js"></script>

    <script type="text/javascript">
        function isInt(n) {
            return n != "" && !isNaN(n) && Math.round(n) == n;
        }
        var isOpen = false;

        var type = "normal";
        var disabled = false;
        var disabledFunction = null;
        var ready4Action = true;
        let checkxy;
        let infoxy;
        var houseId = 0
        var hideoutid = 0
        var clanid = 0
        var stealid = 0
        var Containerid = 0
        var horseid = 0
        var wagonid = 0
        var secondaryCapacityAvailable = false
        let allplayerammo
        let ammolabels
        function OverSetTitle(title) {
            document.getElementById("information").innerHTML = title;
        }

        function OverSetTitleSecond(title) {
            document.getElementById("information2").innerHTML = title;
        }

        function OverSetDesc(title) {
            document.getElementById("description").innerHTML = title;
        }

        function secondarySetTitle(title) {
            document.getElementById("titleHorse").innerHTML = title;
        }

        function secondarySetCurrentCapacity(cap) {
            document.getElementById('current-cap-value').innerHTML = cap
        }

        function secondarySetCapacity(cap) {
            secondaryCapacityAvailable = true
            $(".capacity").show();
            document.getElementById('capacity-value').innerHTML = cap
            secondarySetCurrentCapacity('0')
        }

        function hideSecondaryCapacity() {
            secondaryCapacityAvailable = false
            $(".capacity").hide();
        }

        function initiateSecondaryInventory(id, title, capacity) {
            $("#secondInventoryHud").fadeIn();
            secondarySetTitle(title);

            if (capacity) {
                secondarySetCapacity(capacity);
            } else {
                // Backwards compatible, inventory capacity will not show
                hideSecondaryCapacity();
            }
        }

        window.addEventListener('message', function (event) {

            if (event.data.action == "reclabels") {
                ammolabels = event.data.labels
            }
            if (event.data.action == "updateammo") {
                if (event.data.ammo) {
                    allplayerammo = event.data.ammo
                }
            }

            if (event.data.action == "updateStatusHud") {

                if (event.data.money || event.data.money === 0) {
                    $("#money-value").text(event.data.money.toFixed(2) + " ");

                }
                if (Config.UseGoldItem) {
                    if (event.data.gold || event.data.gold === 0) {
                        $("#gold-value").text(event.data.gold.toFixed(2) + " ");

                    }
                }
                if (event.data.id) {
                    $("#id-value").text("ID " + event.data.id);

                }
                
            }
        });

        $("document").ready(function () {

            $("#secondInventoryHud").draggable();
            $("#inventoryHud").draggable();

            $("#inventoryHud").hide();
            $("#secondInventoryHud").hide();

            $("body").on("keyup", function (key) {
                if (Config.closeKeys.includes(key.which)) {
                    closeInventory();
                }
            });

            $('#inventoryElement').droppable({
                drop: function (event, ui) {
                    itemData = ui.draggable.data("item");
                    itemInventory = ui.draggable.data("inventory");



                    if (type === "horse" && itemInventory === "second") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },

                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/TakeFromHorse", JSON.stringify({
                                        item: itemData,
                                        type: type,
                                        number: value,
                                        horse: horseid
                                    }));

                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/TakeFromHorse", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                horse: horseid
                            }));

                        }
                    } else if (type === "cart" && itemInventory === "second") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },

                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/TakeFromCart", JSON.stringify({
                                        item: itemData,
                                        type: type,
                                        wagon: wagonid,
                                        number: value
                                    }));



                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/TakeFromCart", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                wagon: wagonid,
                                number: 1
                            }));

                        }
                    } else if (type === "house" && itemInventory === "second") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/TakeFromHouse", JSON.stringify({
                                        item: itemData,
                                        type: type,
                                        number: value,
                                        house: houseId
                                    }));


                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/TakeFromHouse", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                house: houseId
                            }));

                        }
                    } else if (type === "hideout" && itemInventory === "second") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/TakeFromHideout", JSON.stringify({
                                        item: itemData,
                                        type: type,
                                        number: value,
                                        hideout: hideoutId
                                    }));


                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/TakeFromHideout", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                hideout: hideoutId
                            }));

                        }
                         } else if (type === "bank" && itemInventory === "second") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantita",
                                button: "Conferma",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/TakeFromBank", JSON.stringify({
                                        item: itemData,
                                        type: type,
                                        number: value,
                                        bank: bankId
                                    }));


                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/TakeFromBank", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                bank: bankId
                            }));

                        }
                        
                    } else if (type === "clan" && itemInventory === "second") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/TakeFromClan", JSON
                                        .stringify({
                                            item: itemData,
                                            type: type,
                                            number: value,
                                            clan: clanid
                                        }));


                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/TakeFromClan", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                clan: clanid
                            }));

                        }
                    } else if (type === "steal" && itemInventory === "second") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/TakeFromsteal", JSON
                                        .stringify({
                                            item: itemData,
                                            type: type,
                                            number: value,
                                            steal: stealid
                                        }));


                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/TakeFromsteal", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                steal: stealid
                            }));

                        }
                    } else if (type === "Container" && itemInventory === "second") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/TakeFromContainer",
                                        JSON.stringify({
                                            item: itemData,
                                            type: type,
                                            number: value,
                                            Container: Containerid
                                        }));


                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/TakeFromContainer", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                Container: Containerid
                            }));

                        }
                    }
                }
            });

            $('#secondInventoryElement').droppable({
                drop: function (event, ui) {
                    itemData = ui.draggable.data("item");
                    itemInventory = ui.draggable.data("inventory");


                    if (type === "horse" && itemInventory === "main") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/MoveToHorse", JSON.stringify({
                                        item: itemData,
                                        type: type,
                                        number: value,
                                        horse: horseid
                                    }));


                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/MoveToHorse", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                horse: horseid
                            }));

                        }

                    } else if (type === "cart" && itemInventory === "main") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/MoveToCart", JSON.stringify({
                                        item: itemData,
                                        type: type,
                                        wagon: wagonid,
                                        number: value
                                    }));

                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/MoveToCart", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                wagon: wagonid,
                                number: 1
                            }));

                        }

                    } else if (type === "house" && itemInventory === "main") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/MoveToHouse", JSON.stringify({
                                        item: itemData,
                                        type: type,
                                        number: value,
                                        house: houseId
                                    }));

                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/MoveToHouse", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                house: houseId
                            }));

                        }
                    } else if (type === "hideout" && itemInventory === "main") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/MoveToHideout", JSON.stringify({
                                        item: itemData,
                                        type: type,
                                        number: value,
                                        hideout: hideoutId
                                    }));

                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/MoveToHideout", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                hideout: hideoutId
                            }));

                        }
 } else if (type === "bank" && itemInventory === "main") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantita",
                                button: "Conferma",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }


                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/MoveToBank", JSON.stringify({
                                        item: itemData,
                                        type: type,
                                        number: value,
                                        bank: bankId
                                    }));

                                }
                            });
                        } else {
                            $.post("http://vorp_inventory/MoveToBank", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                bank: bankId
                            }));

                        }
                    } else if (type === "clan" && itemInventory === "main") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/MoveToClan", JSON.stringify({
                                        item: itemData,
                                        type: type,
                                        number: value,
                                        clan: clanid
                                    }));

                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/MoveToClan", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                clan: clanid
                            }));

                        }

                    } else if (type === "steal" && itemInventory === "main") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/MoveTosteal", JSON
                                        .stringify({
                                            item: itemData,
                                            type: type,
                                            number: value,
                                            steal: stealid
                                        }));

                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/MoveTosteal", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                steal: stealid
                            }));

                        }

                    } else if (type === "Container" && itemInventory === "main") {
                        disableInventory(500);
                        if (itemData.type != "item_weapon") {
                            dialog.prompt({
                                title: "Quantity",
                                button: "Accept",
                                required: true,
                                item: itemData,
                                type: itemData.type,
                                input: {
                                    type: "number",
                                    autofocus: "true"
                                },
                                validate: function (value, item, type) {
                                    if (!value) {
                                        dialog.close()
                                        return;
                                    }

                                    if (!isInt(value)) {
                                        return;
                                    }

                                    $.post("http://vorp_inventory/MoveToContainer", JSON
                                        .stringify({
                                            item: itemData,
                                            type: type,
                                            number: value,
                                            Container: Containerid
                                        }));

                                }
                            });
                        } else {

                            $.post("http://vorp_inventory/MoveToContainer", JSON.stringify({
                                item: itemData,
                                type: itemData.type,
                                number: 1,
                                Container: Containerid
                            }));

                        }

                    }
                }
            });

            window.addEventListener("message", function (event) {
                if (event.data.action == "transaction") {
                    let t = event.data.type
                    if(t == 'started') {
                        let displaytext = event.data.text
                        $('#loading-text').html(displaytext)
                        $('#transaction-loader').show()
                    }
                    if(t == 'completed') {
                        $('#transaction-loader').hide()
                    }
                }

                if (event.data.action == "changecheck") {
                    checkxy = event.data.check
                    infoxy = event.data.info
                    $('#check').html('')
                    $("#check").append(`<button id='check'>${checkxy}/${infoxy}</button>`);
                }
                if (event.data.action == "display") {
                    $("#inventoryHud").fadeIn();
                    $(".controls").remove();

                    $("#inventoryHud").append(
                        `<div class='controls'><div class='controls-center'><input type='text' id='search' placeholder='search'/><button id='check'>${checkxy} / ${infoxy}</button></div><button id='close'>Close</button></div></div>`
                    );

                    $("#search").bind('input', function () {
                        searchFor = $("#search").val().toLowerCase();
                        $(".item").each(function () {
                            label = $(this).data("label").toLowerCase();
                            if (label.indexOf(searchFor) < 0) {
                                $(this).hide();
                            } else {
                                $(this).show();
                            }
                        });
                    });

                    type = event.data.type


                    if (event.data.type == "horse") {
                        horseid = event.data.horseid;
                        initiateSecondaryInventory(horseid, event.data.title, event.data.capacity)
                    }

                    if (event.data.type == "cart") {
                        wagonid = event.data.wagonid;
                        initiateSecondaryInventory(wagonid, event.data.title, event.data.capacity)
                    }

                    if (event.data.type == "house") {
                        houseId = event.data.houseId;
                        initiateSecondaryInventory(houseId, event.data.title, event.data.capacity)
                    }
                    if (event.data.type == "hideout") {
                        hideoutId = event.data.hideoutId;
                        initiateSecondaryInventory(hideoutId, event.data.title, event.data.capacity)
                    }
                     if (event.data.type == "bank") {
                        bankId = event.data.bankId;
                        initiateSecondaryInventory(bankId, event.data.title, event.data.capacity)
                    }
                    if (event.data.type == "clan") {
                        clanid = event.data.clanid;
                        initiateSecondaryInventory(clanid, event.data.title, event.data.capacity)
                    }
                    if (event.data.type == "steal") {
                        stealid = event.data.stealId;
                        initiateSecondaryInventory(stealid, event.data.title, event.data.capacity)
                    }
                    if (event.data.type == "Container") {
                       Containerid = event.data.Containerid;
                       initiateSecondaryInventory(Containerid, event.data.title, event.data.capacity)
                    }

                    disabled = false;

                    $(document).on('keydown', function (event) {
                        $("#search").focus();
                    });

                    $("#close").on('click', function (event) {
                        closeInventory();
                    });
                } else if (event.data.action == "hide") {
                    $("#inventoryHud").fadeOut();
                    $(".controls").fadeOut();
                    $(".site-cm-box").remove();

                    $("#secondInventoryHud").fadeOut();
                    $(".controls").fadeOut();
                    $(".site-cm-box").remove();
                    dialog.close();
                } else if (event.data.action == "setItems") {
                    inventorySetup(event.data.itemList);

                    if (type != "main") {

                        $('.item').draggable({
                            helper: 'clone',
                            appendTo: 'body',
                            zIndex: 99999,
                            revert: 'invalid',
                            start: function (event, ui) {
                                if (disabled) {
                                    return false;
                                }


                                itemData = $(this).data("item");
                                itemInventory = $(this).data("inventory");

                                if (itemInventory === "main") {
                                    $("#inventoryHud").fadeOut();
                                } else if (itemInventory === "second") {
                                    $("#secondInventoryHud").fadeOut();
                                }

                            },
                            stop: function () {
                                itemData = $(this).data("item");
                                itemInventory = $(this).data("inventory");

                                if (itemInventory === "main") {
                                    $("#inventoryHud").fadeIn();
                                } else if (itemInventory === "second") {
                                    $("#secondInventoryHud").fadeIn();
                                }


                            }
                        });
                    }

                } else if (event.data.action == "setSecondInventoryItems") {
                    secondInventorySetup(event.data.itemList);
                    if (secondaryCapacityAvailable == true) {
                        // Get how many items are in inventory
                        let l = event.data.itemList.length
                        let itemlist = event.data.itemList
                        let total = 0
                        let p = 0
                        for (p; p < l; p++) {
                            total += Number(itemlist[p].count)
                        }
                        secondarySetCurrentCapacity(total)
                    }
                } else if (event.data.action == "nearPlayers") {
                    if (event.data.what == "give") {
                        selectPlayerToGive(event.data);
                    }
                }
            });
        });

        function Interval(time) {
            var timer = false;
            this.start = function () {
                if (this.isRunning()) {
                    clearInterval(timer);
                    timer = false;
                }

                timer = setInterval(function () {
                    disabled = false;
                }, time);
            };
            this.stop = function () {
                clearInterval(timer);
                timer = false;
            };
            this.isRunning = function () {
                return timer !== false;
            };
        }

        function disableInventory(ms) {
            disabled = true;

            if (disabledFunction === null) {
                disabledFunction = new Interval(ms);
                disabledFunction.start();
            } else {
                if (disabledFunction.isRunning()) {
                    disabledFunction.stop();
                }

                disabledFunction.start();
            }
        }

        function selectPlayerToGive(data) {
            dialog.prompt({
                title: "Select Player",
                button: "Confirm",
                required: false,
                item: data,
                type: data.type,
                select: true,
                validate: function (value, data, player) {
                    $.post("http://vorp_inventory/GiveItem", JSON.stringify({
                        player: player,
                        data: data
                    }));
                    return true;
                }
            });
        }

        function dropGetHowMany(item, type, hash, id) {
            if (type != "item_weapon") {
                dialog.prompt({
                    title: "Quantity",
                    button: "Accept",
                    required: true,
                    item: item,
                    type: type,
                    input: {
                        type: "number",
                        autofocus: "true",
                    },
                    validate: function (value, item, type) {
                        if (!value) {
                            dialog.close()
                            return;
                        }
                        if (!isInt(value)) {
                                return;
                            } 
                        $.post("http://vorp_inventory/DropItem", JSON.stringify({
                            item: item,
                            type: type,
                            number: value
                        }));
                        return true;
                    }
                });
            } else {
                $.post("http://vorp_inventory/DropItem", JSON.stringify({
                    item: item,
                    type: type,
                    hash: hash,
                    id: parseInt(id)
                }));
            }
        }

        function giveGetHowMany(item, type, hash, id) {
            if (type != "item_weapon") {
                dialog.prompt({
                    title: "Quantity",
                    button: "Accept",
                    required: false,
                    item: item,
                    type: type,
                    input: {
                        type: "number",
                        autofocus: "true"
                    },
                    validate: function (value, item, type) {
                        if (!value) {
                            dialog.close()
                            return;
                        }
                        if (!isInt(value)) {
                                return;
                            } 
                        $.post("http://vorp_inventory/GetNearPlayers", JSON.stringify({
                            type: type,
                            what: "give",
                            item: item,
                            count: value
                        }));
                        return true;
                    }
                });
            } else {
                $.post("http://vorp_inventory/GetNearPlayers", JSON.stringify({
                    type: type,
                    what: "give",
                    item: item,
                    hash: hash,
                    id: parseInt(id)
                }));
            }
        }

        function giveGetHowManyMoney() {
            dialog.prompt({
                title: "Quantity",
                button: "Accept",
                required: true,
                item: "money",
                type: "item_money",
                input: {
                    type: "number",
                    autofocus: "true"
                },
                validate: function (value, item, type) {
                    if (!value) {
                        dialog.close()
                        return;
                    }
                    $.post("http://vorp_inventory/GetNearPlayers", JSON.stringify({
                        type: type,
                        what: "give",
                        item: item,
                        count: value
                    }));
                    return true;
                }
            });

        }

        function giveammotoplayer(ammotype) {
            dialog.prompt({
                title: "Quantity",
                button: "Accept",
                required: true,
                item: ammotype,
                type: "item_ammo",
                input: {
                    type: "number",
                    autofocus: "true"
                },
                validate: function (value, item, type) {
                    if (!value) {
                        dialog.close()
                        return;
                    }
                     if (!isInt(value)) {
                         return;
                        }
                    $.post("http://vorp_inventory/GetNearPlayers", JSON.stringify({
                        type: type,
                        what: "give",
                        item: item,
                        count: value
                    }));
                    return true;
                }
            });

        }

        function giveGetHowManyGold() {
            dialog.prompt({
                title: "Quantity",
                button: "Accept",
                required: true,
                item: "gold",
                type: "item_gold",
                input: {
                    type: "number",
                    autofocus: "true"
                },
                validate: function(value, item, type) {
                    if (!value) {
                        dialog.close()
                        return;
                    }
                    $.post("http://vorp_inventory/GetNearPlayers", JSON.stringify({
                        type: type,
                        what: "give",
                        item: item,
                        count: value
                    }));
                    return true;
                }
            });

        }

        function closeInventory() {
            $.post("http://vorp_inventory/NUIFocusOff", JSON.stringify({}));
            isOpen = false;
        }

        function inventorySetup(items) {
            $("#inventoryElement").html("");


            $.each(items, function (index, item) {
                count = item.count;

                if (item.limit > 0) {
                    count = count + " / " + item
                        .limit; /*   count = count + "" ;   if you want to disable the count max items add this instead. */
                }
                if (item.type != "item_weapon") {
                    $("#inventoryElement").append("<div data-label='" + item.label +
                    "' style='background-image: url(\"img/items/" + item.name.toLowerCase() +
                    ".png\"), url(); background-size: 90px 90px, 90px 90px; background-repeat: no-repeat; background-position: center;' id='item-" +
                    index + "' class='item'><div class='count'>" + count +
                    "</div><div class='text'></div></div>")
                }else{
                    $("#inventoryElement").append("<div data-label='" + item.label +
                    "' style='background-image: url(\"img/items/" + item.name.toLowerCase() +
                    ".png\"), url(); background-size: 90px 90px, 90px 90px; background-repeat: no-repeat; background-position: center;' id='item-" +
                    index + "' class='item'></div></div>")
                }

                $('#item-' + index).data('item', item);
                $('#item-' + index).data('inventory', "main");

                var data = [];
                if (item.used) {
                    data.push({
                        text: "Unequip",
                        action: function () {
                            $.post("http://vorp_inventory/UnequipWeapon", JSON.stringify({
                                item: item.name,
                                id: item.id
                            }));
                        }
                    })
                }
                if (item.used2) {
                    data.push({
                        text: "Unequip",
                        action: function () {
                            $.post("http://vorp_inventory/UnequipWeapon", JSON.stringify({
                                item: item.name,
                                id: item.id
                            }));
                        }
                    })
                }
                if (item.usable) {
                    data.push({
                        text: "Use",
                        action: function () {
                            $.post("http://vorp_inventory/UseItem", JSON.stringify({
                                item: item.name,
                                type: item.type,
                                hash: item.hash,
                                amount: item.count,
                                id: item.id
                            }));
                        }
                    });
                }

                if (item.canRemove) {
                    data.push({
                        text: "Give",
                        action: function () {
                            giveGetHowMany(item.name, item.type, item.hash, item.id);
                        }
                    });

                    data.push({
                        text: "Drop",
                        action: function () {
                            dropGetHowMany(item.name, item.type, item.hash, item.id);
                        }
                    });
                }

                if (data.length > 0) {
                    $("#item-" + index).contextMenu([data], {
                        offsetX: 1,
                        offsetY: 1,
                    });
                }

                $("#item-" + index).hover(
                    function () {
                        OverSetTitle(item.label);
                    },
                    function () {
                        OverSetTitle(" ");
                    }
                );

                $("#item-" + index).hover(
                    function () {
                        OverSetDesc(item.desc);
                    },
                    function () {
                        OverSetDesc(" ");
                    }
                );

            });

            var gunbelt_item = "gunbelt"
            var gunbelt_label = "Gun belt"
            var gunbelt_desc = "Your Ammo"

            $("#inventoryElement").append("<div data-label='" + gunbelt_label +
                "' style='background-image: url(\"img/items/" + gunbelt_item +
                ".png\"), url(); background-size: 90px 90px, 90px 90px; background-repeat: no-repeat; background-position: center;' id='item-" +
                gunbelt_item + "' class='item'><div class='text'></div></div>")
            var data = [];
            for (const [ind, tab] of Object.entries(allplayerammo)) {
                if (tab > 0) {
                    data.push({
                        text: `${ammolabels[ind]} : ${tab}`,
                        action: function () {
                            giveammotoplayer(ind);
                        }
                    });
                }
            }
            $("#item-" + gunbelt_item).contextMenu([data], {
                offsetX: 1,
                offsetY: 1,
            });


            $("#item-" + gunbelt_item).hover(
                function() {
                    OverSetTitle(gunbelt_label);
                },
                function() {
                    OverSetTitle(" ");
                }
            );

            $('#item-' + gunbelt_item).hover(
                  function() {
                          OverSetDesc(gunbelt_desc);
                  },
                  function() {
                      OverSetDesc(" ");
                  }
              )
            $('#item-' + gunbelt_item).data('item', gunbelt_item);
            $('#item-' + gunbelt_item).data('inventory', "none");

            isOpen = true;
            initDivMouseOver()
            //AddMoney
            var m_item = "money";
            var m_label = "Dollars";
            var m_desc = "Your Cash"


            $("#inventoryElement").append("<div data-label='" + m_label +
                "' style='background-image: url(\"img/items/" + m_item +
                ".png\"), url(); background-size: 90px 90px, 90px 90px; background-repeat: no-repeat; background-position: center;' id='item-" +
                m_item + "' class='item'><div class='text'></div></div>")

            var data = [];

            data.push({
                text: "Give money",
                action: function () {
                    giveGetHowManyMoney();
                }
            });

            data.push({
                text: "Drop money",
                action: function () {
                    dropGetHowMany(m_item, "item_money", "asd", 0);
                }
            });



            $("#item-" + m_item).contextMenu([data], {
                offsetX: 1,
                offsetY: 1,
            });
            $("#item-" + m_item).hover(
                function() {
                    OverSetTitle(m_item);
                },
                function() {
                    OverSetTitle(" ");
                }
            );

            $("#item-" + m_item).hover(
                function () {
                    OverSetDesc(m_desc);
                },
                function () {
                    OverSetDesc(" ");
                }
            );

            $('#item-' + m_item).data('item', m_item);
            $('#item-' + m_item).data('inventory', "none");

            isOpen = true;
            initDivMouseOver()
            
        if (Config.UseGoldItem) {
                  
                  //AddGold
                  var g_item = "gold";
                  var g_label = "Gold";
                  var g_desc = "Your Gold"
      
      
                  $("#inventoryElement").append("<div data-label='" + g_label +
                      "' style='background-image: url(\"img/items/" + g_item +
                      ".png\"), url(); background-size: 90px 90px, 90px 90px; background-repeat: no-repeat; background-position: center;' id='item-" +
                      g_item + "' class='item'><div class='text'></div></div>")
      
                  var data = [];
      
                  data.push({
                      text: "Give Gold",
                      action: function() {
                          giveGetHowManyGold();
                      }
                  });
      
                  data.push({
                      text: "Drop Gold",
                      action: function() {
                          dropGetHowMany(g_item, "item_gold", "asd", 0);
                      }
                  });
      
      
      
                  $("#item-" + g_item).contextMenu([data], {
                      offsetX: 1,
                      offsetY: 1,
                  });
      
      
                  $("#item-" + g_item).hover(
                      function() {
                          OverSetTitle(g_label);
                      },
                      function() {
                          OverSetTitle(" ");
                      }
                  );
      
                  $('#item-' + g_item).hover(
                        function() {
                                OverSetDesc(g_desc);
                        },
                        function() {
                            OverSetDesc(" ");
                        }
                    );

                  $('#item-' + g_item).data('item', g_item);
                  $('#item-' + g_item).data('inventory', "none");
      
                  isOpen = true;
                  initDivMouseOver()
            }
      
        }

        function secondInventorySetup(items) {
            $("#inventoryElement").html("");
            $("#secondInventoryElement").html("");

            $.each(items, function (index, item) {
                count = item.count;

                $("#secondInventoryElement").append("<div data-label='" + item.label +
                    "' style='background-image: url(\"img/items/" + item.name.toLowerCase() +
                    ".png\"), url(); background-size: 90px 90px, 90px 90px; background-repeat: no-repeat; background-position: center;' id='item-" +
                    index + "' class='item'><div class='count'>" + count +
                    "</div><div class='text'></div></div>")
                $('#item-' + index).data('item', item);
                $('#item-' + index).data('inventory', "second");

                $("#item-" + index).hover(
                    function () {
                        OverSetTitleSecond(item.label);
                    },
                    function () {
                        OverSetTitleSecond(" ");
                    },
                    function() {
                        OverSetDesc(item.desc);
                    },
                    function() {
                        OverSetDesc(" ");
                    }
                );

            });
        }

        window.onload = initDivMouseOver;

        function initDivMouseOver() {
            if (isOpen === true) {
                var div = document.getElementById("inventoryElement");
                div.mouseIsOver = false;
                div.onmouseover = function () {
                    this.mouseIsOver = true;
                    $.post("http://vorp_inventory/sound");
                };
                div.onmouseout = function () {
                    this.mouseIsOver = false;


                }
                div.onclick = function () {
                    if (this.mouseIsOver) {


                    }
                }
            }
        }
    </script>

</body>

</html>
